#!/bin/bash

# Configuration
GEMFILE_PATH="Gemfile"
FRONTEND_DEPENDENCIES_PATH="app/views/layouts/_dependencies.erb"
OUTPUT_PATH="AGENTS.md"

# Function to add a dependency section to the output file
add_dependency_section() {
  local title="$1"
  local file_path="$2"
  
  {
    echo ""
    echo "## $title"
    echo ""
    echo "\`\`\`"
    cat "$file_path"
    echo "\`\`\`"
  } >> "$OUTPUT_PATH"
}

# Create the output file with initial instructions
cat > "$OUTPUT_PATH" << 'EOF'

# Dependencies
EOF

# Add content
add_dependency_section "Gemfile" "$GEMFILE_PATH"
add_dependency_section "Frontend dependencies" "$FRONTEND_DEPENDENCIES_PATH"

# Stage the updated file so it's included in this commit
git add "$OUTPUT_PATH"
